{"is_source_file": true, "format": "TypeScript", "description": "This file defines an Angular service that interfaces with a Supabase backend for managing game scores and leaderboards. It includes methods for saving scores, retrieving leaderboards, and fetching user history, along with configuration handling and error management.", "external_files": ["../env"], "external_methods": ["createClient"], "published": ["GameResult", "LeaderboardRow", "SupabaseService"], "classes": [{"name": "SupabaseService", "description": "Angular service providing methods to interact with the Supabase backend for storing and retrieving game scores and leaderboards."}], "methods": [{"name": "isConfigured(): boolean { isConfigured", "description": "Checks if the Supabase client is properly configured.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "async saveScore(username: string, result: GameResult): Promise<{ ok: true } | { ok: false; mes/ saveScore", "description": "Saves a game result (win, draw, loss) for a user to the Supabase 'scores' table.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "async getLeaderboard(): Promise<{ ok: true; data: LeaderboardRow[] } | { ok: false; message: s/ getLeaderboard", "description": "Retrieves the top 10 leaderboard entries, integrating scores and latest game dates.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "async getUserHistory(username: string): Promise<{ ok: true; data: ScoreRow[] } | { ok: false; / getUserHistory", "description": "Fetches the last 20 game scores played by a specific user.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "private mapResultToScore(result: GameResult): number { mapResultToScore", "description": "Converts a GameResult string to its numeric score equivalent.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "private isMissingTableError(error: { message: string; code?: string }): boolean { isMissingTableError", "description": "Detects if an error is due to a missing or inaccessible database table.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "private schemaHelpMessage(): string { schemaHelpMessage", "description": "Provides SQL commands and policies for creating the required database table in Supabase.", "scope": "SupabaseService", "scopeKind": "class"}, {"name": "constructor() { constructor", "scope": "SupabaseService", "scopeKind": "class", "description": "unavailable"}], "calls": ["createClient", "this.client.from", "this.client.select", "this.client.insert", "this.client.eq", "this.client.order", "this.client.limit"], "search-terms": ["supabase", "leaderboard", "score save", "user history", "SupabaseClient", "ScoreRow", "GameResult", "supabase-js", "Angular service", "frontend API"], "state": 2, "file_id": 23, "knowledge_revision": 79, "git_revision": "660a6f2e9649977198d160213c45c250e5d62ae1", "revision_history": [{"64": "cacdd8587e8f9b7d0009dd07d4a29dd7258e6afc"}, {"75": "cacdd8587e8f9b7d0009dd07d4a29dd7258e6afc"}, {"79": "660a6f2e9649977198d160213c45c250e5d62ae1"}], "ctags": [{"_type": "tag", "name": "GameResult", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^export type GameResult = 'win' | 'draw' | 'loss';$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "LeaderboardRow", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^export interface LeaderboardRow {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "ScoreRow", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^interface ScoreRow {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "SupabaseClient", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^import { createClient, type SupabaseClient } from '@supabase\\/supabase-js';$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "SupabaseService", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^export class SupabaseService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "client", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  private readonly client: SupabaseClient | null;$/", "language": "TypeScript", "kind": "property", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  constructor() {$/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  created_at?: string;$/", "language": "TypeScript", "kind": "property", "scope": "ScoreRow", "scopeKind": "interface"}, {"_type": "tag", "name": "getLeaderboard", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  async getLeaderboard(): Promise<{ ok: true; data: LeaderboardRow[] } | { ok: false; message: s/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "getUserHistory", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  async getUserHistory(username: string): Promise<{ ok: true; data: ScoreRow[] } | { ok: false; /", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  id?: string;$/", "language": "TypeScript", "kind": "property", "scope": "ScoreRow", "scopeKind": "interface"}, {"_type": "tag", "name": "insert", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const insert = await this.client.from('scores').insert(payload);$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.saveScore", "scopeKind": "method"}, {"_type": "tag", "name": "isConfigured", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  isConfigured(): boolean {$/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "isMissingTableError", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  private isMissingTableError(error: { message: string; code?: string }): boolean {$/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "latest_played", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  latest_played: string;$/", "language": "TypeScript", "kind": "property", "scope": "LeaderboardRow", "scopeKind": "interface"}, {"_type": "tag", "name": "map", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^      const map = new Map<string, { total: number; latest: string }>();$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getLeaderboard", "scopeKind": "method"}, {"_type": "tag", "name": "mapResultToScore", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  private mapResultToScore(result: GameResult): number {$/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^      const msg = this.schemaHelpMessage();$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.saveScore", "scopeKind": "method"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const msg = (error.message || '').toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.isMissingTableError", "scopeKind": "method"}, {"_type": "tag", "name": "numeric", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const numeric = this.mapResultToScore(result);$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.saveScore", "scopeKind": "method"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const payload: ScoreRow = { username, result: numeric };$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.saveScore", "scopeKind": "method"}, {"_type": "tag", "name": "prev", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^        const prev = map.get(row.username);$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getLeaderboard", "scopeKind": "method"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const res = await this.client$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getLeaderboard", "scopeKind": "method"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const res = await this.client$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getUserHistory", "scopeKind": "method"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^    const payload: ScoreRow = { username, result: numeric };$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.saveScore", "scopeKind": "method"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  result: number; \\/\\/ 1 | 0.5 | 0$/", "language": "TypeScript", "kind": "property", "scope": "ScoreRow", "scopeKind": "interface"}, {"_type": "tag", "name": "row", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^      for (const row of res.data as ScoreRow[]) {$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getLeaderboard", "scopeKind": "method"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^      const rows: LeaderboardRow[] = Array.from(map.entries()).map(([username, agg]) => ({$/", "language": "TypeScript", "kind": "constant", "scope": "SupabaseService.getLeaderboard", "scopeKind": "method"}, {"_type": "tag", "name": "saveScore", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  async saveScore(username: string, result: GameResult): Promise<{ ok: true } | { ok: false; mes/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "schemaHelpMessage", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  private schemaHelpMessage(): string {$/", "language": "TypeScript", "kind": "method", "scope": "SupabaseService", "scopeKind": "class"}, {"_type": "tag", "name": "total_score", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  total_score: number;$/", "language": "TypeScript", "kind": "property", "scope": "LeaderboardRow", "scopeKind": "interface"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  username: string;$/", "language": "TypeScript", "kind": "property", "scope": "LeaderboardRow", "scopeKind": "interface"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  username: string;$/", "language": "TypeScript", "kind": "property", "scope": "ScoreRow", "scopeKind": "interface"}, {"_type": "tag", "name": "warnedAboutSchema", "path": "/home/kavia/workspace/code-generation/tic-tac-toe-score-tracker-301751-301763/tic_tac_toe_frontend/src/app/services/supabase.service.ts", "pattern": "/^  private warnedAboutSchema = false;$/", "language": "TypeScript", "kind": "property", "scope": "SupabaseService", "scopeKind": "class"}], "hash": "bb67a8d21f636cb0274cb8429998ad9a", "format-version": 4, "code-base-name": "tic_tac_toe_frontend", "filename": "tic_tac_toe_frontend/src/app/services/supabase.service.ts", "fields": [{"name": "export interface LeaderboardRow {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "interface ScoreRow {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private readonly client: SupabaseClient | null;", "scope": "SupabaseService", "scopeKind": "class", "description": "unavailable"}, {"name": "created_at?: string;", "scope": "ScoreRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "id?: string;", "scope": "ScoreRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "latest_played: string;", "scope": "LeaderboardRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "result: number; \\/\\/ 1 | 0.5 | 0", "scope": "ScoreRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "total_score: number;", "scope": "LeaderboardRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "username: string;", "scope": "LeaderboardRow", "scopeKind": "interface", "description": "unavailable"}, {"name": "private warnedAboutSchema = false;", "scope": "SupabaseService", "scopeKind": "class", "description": "unavailable"}]}